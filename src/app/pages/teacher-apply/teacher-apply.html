<tmf-layout-1-wapper>
  <div class="flex justify-center items-center min-h-screen">
    <!-- Main Form Container -->
    <div
      class="relative z-10 w-full max-w-4xl bg-white rounded-3xl shadow-2xl p-8 lg:p-12 mx-6"
    >
      <!-- Header -->
      <div class="flex items-center justify-between mb-8">
        <button
          (click)="goBack()"
          class="cursor-pointer flex items-center text-grey-66 hover:text-grey-33 transition-colors"
        >
          <mat-icon class="!w-6 !h-6">
            {{ TmfIcon.KeyboardArrowLeft }}
          </mat-icon>
        </button>

        <h1 class="text-4xl-bold text-primary">教師申請</h1>

        <div class="w-6"></div>
        <!-- Spacer for centering -->
      </div>

      <!-- Stepper -->
      <div class="mb-10">
        <tmf-stepper
          [steps]="steps"
          [currentStep]="currentStep()"
          [showOnlyCurrentLabel]="false"
          (stepChange)="onStepChange($event)"
        ></tmf-stepper>
      </div>

      <!-- Step 1: 基本資料 -->
      @if (currentStep() === 1) {
        <tmf-basic-info-form
          #basicInfoForm
          [initialData]="formData.basicInfo"
          (formValid)="onStep1ValidChange($event)"
          (formSubmit)="onStep1Submit($event)"
        ></tmf-basic-info-form>
      }

      <!-- Step 2: 工作經驗 -->
      @if (currentStep() === 2) {
        <tmf-work-experiences-form
          #workExperiencesForm
          [initialData]="formData.workExperiences"
          (formValid)="onStep2ValidChange($event)"
          (formSubmit)="onStep2Submit($event)"
        ></tmf-work-experiences-form>
      }

      <!-- Step 3: 學歷背景 -->
      @if (currentStep() === 3) {
        <tmf-learning-experiences-form
          #learningExperiencesForm
          [initialData]="formData.learningExperiences"
          (formValid)="onStep3ValidChange($event)"
          (formSubmit)="onStep3Submit($event)"
        ></tmf-learning-experiences-form>
      }

      <!-- Step 4: 教學證照 -->
      @if (currentStep() === 4) {
        <tmf-certificates-form
          #certificatesForm
          [initialData]="formData.certificates"
          (formValid)="onStep4ValidChange($event)"
          (formSubmit)="onStep4Submit($event)"
        ></tmf-certificates-form>
      }

      <!-- Navigation Buttons -->
      <div class="flex gap-4 pt-6 mt-8">
        @if (currentStep() > 1) {
          <tmf-button
            type="button"
            variant="secondary"
            class="flex-1 h-12"
            (click)="goToPrevStep()"
          >
            上一步
          </tmf-button>
        }
        
        @if (currentStep() < 4) {
          <tmf-button
            type="button"
            class="flex-1 h-12"
            [disabled]="!canGoToStep(currentStep() + 1)"
            (click)="goToNextStep()"
          >
            @switch (currentStep()) {
              @case (1) { 下一步：工作經驗 }
              @case (2) { 下一步：學歷背景 }
              @case (3) { 下一步：教學證照 }
            }
          </tmf-button>
        } @else {
          <tmf-button
            type="button"
            class="flex-1 h-12"
            [disabled]="!step4Valid()"
            (click)="goToNextStep()"
          >
            提交申請
          </tmf-button>
        }
      </div>
    </div>
  </div>
</tmf-layout-1-wapper>