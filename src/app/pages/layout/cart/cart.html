<section class="bg-white py-10 xl:pt-10 xl:pb-20">
  <div class="container mx-auto w-full max-w-320 flex flex-col gap-6">
    <!-- 步驟指示器 -->
    <tmf-stepper 
      class="py-4"
      [steps]="steps" 
      [currentStep]="currentStep()"
      [showOnlyCurrentLabel]="false"
      (stepChange)="onStepChange($event)"
    ></tmf-stepper>

    <!-- 主要內容區 -->
    <div class="flex flex-col gap-6 xl:flex-row">
      <!-- 購物車清單 -->
      <div class="w-full xl:w-238.5">
        <tmf-table>
          <!-- 表頭 -->
          <div thead class="flex w-full">
            <div class="flex w-12 items-center justify-center py-2 px-4">
              <input
                type="checkbox"
                [checked]="isAllSelected()"
                [indeterminate]="isSomeSelected()"
                (change)="toggleSelectAll()"
                class="h-5 w-5 rounded border border-grey-d4 bg-white"
              />
            </div>
            <div class="flex-1 px-4 flex items-center">
              <span class="text-sm text-white">課程</span>
            </div>
            <div class="w-35 px-3 text-center flex items-center justify-center">
              <span class="text-sm text-white">售價</span>
            </div>
            <div class="w-30 px-3 text-center flex items-center justify-center">
              <span class="text-sm text-white">操作</span>
            </div>
          </div>

          <!-- 表體 -->
          @for (courseItem of itemsWithSelection(); track courseItem.id) {
            <div 
              tbody 
              [class.selected]="courseItem.isSelected"
            >
              <!-- 勾選欄位 -->
              <div class="flex w-12 items-center justify-center px-4">
                <input
                  type="checkbox"
                  [checked]="courseItem.isSelected"
                  (change)="toggleSelectItem(courseItem)"
                  class="h-5 w-5 rounded border transition-colors duration-200"
                />
              </div>
              
              <!-- 課程內容 -->
              <div class="flex flex-1 items-center gap-3 px-4">
                <!-- 課程圖片 -->
                <div class="h-28 w-50 overflow-hidden rounded-lg">
                  <img
                    [src]="courseItem.image"
                    [alt]="courseItem.title"
                    class="h-full w-full object-cover"
                  />
                </div>
                <!-- 課程資訊 -->
                <div class="flex flex-col gap-1">
                  <!-- 標籤 -->
                  <div class="flex gap-2">
                    @for (tag of courseItem.tags; track tag) {
                      <span class="rounded bg-grey-d4 px-2 py-1 text-sm text-grey-33">{{ tag }}</span>
                    }
                  </div>
                  <!-- 課程標題 -->
                  <h3 class="text-lg-bold text-grey-33">{{ courseItem.title }}</h3>
                  <!-- 課程類型 -->
                  <p class="text-sm text-grey-66">{{ courseItem.type }}</p>
                </div>
              </div>

              <!-- 價格 -->
              <div class="flex w-35 items-center justify-center px-3">
                <span class="font-inter text-lg font-medium text-grey-33">NT$ {{ courseItem.price | number }}</span>
              </div>

              <!-- 操作 -->
              <div class="flex w-30 items-center justify-center gap-3 px-3">
                <button 
                  class="text-grey-66 hover:text-grey-33"
                  (click)="deleteCourse(courseItem)"
                >
                  <mat-icon class="!text-6 !h-6 !w-6">delete</mat-icon>
                </button>
                <button 
                  class="text-grey-66 hover:text-grey-33"
                  (click)="toggleFavorite(courseItem)"
                >
                  <mat-icon class="!text-6 !h-6 !w-6">favorite_border</mat-icon>
                </button>
              </div>
            </div>
          }
        </tmf-table>
      </div>

      <!-- 右側訂單總計 -->
      <div class="w-full xl:w-75.5 xl:flex-1">
        <div class="flex flex-col gap-6 rounded-xl bg-white p-6 shadow-lg">
          <!-- 標題 -->
          <h2 class="text-xl-bold leading-7 text-grey-33">我的訂單</h2>
          
          <!-- 統計資訊 -->
          <div class="space-y-3 pt-6">
            <!-- 共計 -->
            <div class="flex justify-end items-center gap-1 text-lg text-grey-66">
              <span>共計</span>
              <span class="font-inter font-medium">1</span>
              <span>項課程</span>
            </div>
            
            <!-- 總計 -->
            <div class="flex justify-end items-baseline gap-1">
              <span class="text-base text-grey-33">總計</span>
              <span class="font-inter text-4xl font-medium uppercase text-grey-33">NT$</span>
              <span class="font-inter text-4xl font-medium uppercase text-grey-33">1,200</span>
            </div>
          </div>

          <!-- 按鈕區 -->
          <div class="space-y-4">
            <tmf-button class="h-13">前往結帳</tmf-button>
            <tmf-button class="h-13" variant="secondary">繼續購物</tmf-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- 我的收藏區塊 -->
<section class="bg-grey-f7 py-10 xl:pt-10 xl:pb-20">
  <div class="container mx-auto w-full max-w-320">
    <!-- 段落標題 -->
    <tmf-course-detail-section-title class="mb-6">
      我的收藏
    </tmf-course-detail-section-title>
    
    <!-- 收藏課程卡片列表 -->
    <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
      @for (course of favoriteCoursesData(); track course.id) {
        <tmf-course-card [course]="course"></tmf-course-card>
      }
    </div>
  </div>
</section>