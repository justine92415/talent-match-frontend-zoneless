@if (reservationsResource.isLoading()) {
  <div class="flex items-center justify-center p-4">
    <div class="text-grey-66">è¼‰å…¥ä¸­...</div>
  </div>
} @else if (reservationsResource.error()) {
  <div class="flex items-center justify-center p-4">
    <div class="text-center">
      <div class="text-red-600 mb-2">è¼‰å…¥å¤±æ•—</div>
      <button
        class="text-primary hover:underline"
        (click)="reservationsResource.reload()">
        é‡æ–°è¼‰å…¥
      </button>
    </div>
  </div>
} @else {
  @if (reservationsResource.value()?.data?.reservations && reservationsResource.value()!.data!.reservations!.length > 0) {
    <div class="space-y-3">
      @for (reservation of reservationsResource.value()?.data?.reservations; track reservation.id) {
        <div class="rounded-lg border border-grey-e5 bg-white p-4">
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <div class="flex items-center gap-3">
                <span class="font-medium">{{ reservation.reserve_time | date:'yyyy-MM-dd HH:mm':'UTC' }}</span>
                <span
                  class="px-2 py-1 text-xs rounded-full"
                  [ngClass]="{
                    'bg-green-95 text-green-55': reservation.teacher_status === 'reserved' && reservation.student_status === 'reserved',
                    'bg-orange-95 text-orange-55': reservation.teacher_status === 'pending' && reservation.student_status === 'reserved',
                    'bg-blue-95 text-blue-50': reservation.teacher_status === 'completed' && reservation.student_status === 'completed',
                    'bg-grey-f4 text-grey-66': reservation.teacher_status === 'cancelled' || reservation.student_status === 'cancelled'
                  }">
                  {{ reservation.teacher_status | reservationStatus: reservation.student_status }}
                </span>
              </div>

              <!-- æ‹’çµ•åŸå›  (å¦‚æœå­˜åœ¨) -->
              @if (reservation.rejection_reason) {
                <div class="mt-2 text-xs text-red-500">
                  {{ reservation.rejection_reason }}
                </div>
              }
            </div>
            @if (reservation.student_status === 'reserved' && (reservation.teacher_status === 'reserved' || reservation.teacher_status === 'pending')) {
              <tmf-button
                variant="tertiary"
                size="sm"
                (click)="onCancelReservation(reservation.id!)">
                å–æ¶ˆé ç´„
              </tmf-button>
            }
          </div>
        </div>
      }
    </div>

    <!-- åˆ†é æ§åˆ¶ -->
    @if (reservationsResource.value()?.data?.pagination && reservationsResource.value()!.data!.pagination!.total_pages! > 1) {
      <div class="flex justify-center items-center gap-2 mt-4 pt-4 border-t border-grey-e5">
        <!-- ä¸Šä¸€é  -->
        <tmf-button
          variant="tertiary"
          size="sm"
          [disabled]="currentPage() <= 1"
          (click)="onPageChange(currentPage() - 1)">
          ä¸Šä¸€é 
        </tmf-button>

        <!-- é ç¢¼é¡¯ç¤º -->
        <span class="text-sm text-grey-66 mx-2">
          ç¬¬ {{ currentPage() }} é  / å…± {{ reservationsResource.value()?.data?.pagination?.total_pages }} é 
        </span>

        <!-- ä¸‹ä¸€é  -->
        <tmf-button
          variant="tertiary"
          size="sm"
          [disabled]="currentPage() >= (reservationsResource.value()?.data?.pagination?.total_pages || 1)"
          (click)="onPageChange(currentPage() + 1)">
          ä¸‹ä¸€é 
        </tmf-button>
      </div>
    }
  } @else {
    <div class="text-center p-8 text-grey-66">
      <div class="mb-2">ğŸ“…</div>
      <div>å°šç„¡é ç´„è¨˜éŒ„</div>
    </div>
  }
}